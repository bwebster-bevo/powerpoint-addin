<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Consulting PowerTools</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 15px;
            background-color: #f5f5f5;
        }
        
        h2 {
            color: #86BC25;
            margin-top: 0;
            font-size: 18px;
            border-bottom: 2px solid #86BC25;
            padding-bottom: 8px;
        }
        
        .section {
            background: white;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .button-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        button {
            background-color: #86BC25;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: background-color 0.2s;
        }
        
        button:hover {
            background-color: #6FA01E;
        }
        
        button:active {
            background-color: #5A8619;
        }
        
        button.full-width {
            grid-column: 1 / -1;
        }
        
        .input-group {
            margin-bottom: 10px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-size: 12px;
            color: #333;
            font-weight: 600;
        }
        
        input, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 13px;
        }
        
        .harvey-ball-selector {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-top: 10px;
        }
        
        .harvey-option {
            width: 40px;
            height: 40px;
            border: 2px solid #ccc;
            border-radius: 50%;
            cursor: pointer;
            position: relative;
            background: white;
        }
        
        .harvey-option:hover {
            border-color: #86BC25;
        }
        
        .harvey-option.selected {
            border-color: #86BC25;
            border-width: 3px;
        }
        
        .status-icons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-top: 10px;
        }
        
        .status-icon {
            padding: 10px;
            border: 2px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            text-align: center;
            font-size: 20px;
            background: white;
        }
        
        .status-icon:hover {
            border-color: #86BC25;
        }
        
        .status-icon.selected {
            border-color: #86BC25;
            background-color: #f0f9e6;
        }
        
        #status {
            margin-top: 10px;
            padding: 10px;
            background-color: #e8f5e9;
            border-radius: 4px;
            font-size: 12px;
            display: none;
        }
        
        #status.error {
            background-color: #ffebee;
            color: #c62828;
        }
        
        #status.success {
            background-color: #e8f5e9;
            color: #2e7d32;
        }
        
        .color-picker {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }
        
        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid #ccc;
        }
        
        .color-option:hover {
            border-color: #86BC25;
        }
        
        .color-option.selected {
            border-width: 3px;
            border-color: #86BC25;
        }
    </style>
</head>
<body>
    <h2>‚ö° Consulting PowerTools</h2>
    
    <div class="section">
        <h3 style="margin-top: 0; font-size: 14px;">üìç Alignment Tools</h3>
        <div class="button-grid">
            <button onclick="alignLeft()">Align Left</button>
            <button onclick="alignCenter()">Align Center</button>
            <button onclick="alignRight()">Align Right</button>
            <button onclick="alignTop()">Align Top</button>
            <button onclick="distributeHorizontally()">Distribute H</button>
            <button onclick="distributeVertically()">Distribute V</button>
            <button onclick="copyPosition()" class="full-width">Copy Position</button>
        </div>
    </div>
    
    <div class="section">
        <h3 style="margin-top: 0; font-size: 14px;">‚ö™ Harvey Balls</h3>
        <div class="input-group">
            <label>Select Fill Level:</label>
            <div class="harvey-ball-selector">
                <div class="harvey-option" onclick="selectHarveyBall(0)" data-fill="0">
                    <svg width="36" height="36" style="position: absolute; top: 2px; left: 2px;">
                        <circle cx="18" cy="18" r="16" fill="white" stroke="#333" stroke-width="2"/>
                    </svg>
                </div>
                <div class="harvey-option" onclick="selectHarveyBall(25)" data-fill="25">
                    <svg width="36" height="36" style="position: absolute; top: 2px; left: 2px;">
                        <circle cx="18" cy="18" r="16" fill="white" stroke="#333" stroke-width="2"/>
                        <path d="M 18 18 L 18 2 A 16 16 0 0 1 34 18 Z" fill="#86BC25"/>
                    </svg>
                </div>
                <div class="harvey-option selected" onclick="selectHarveyBall(50)" data-fill="50">
                    <svg width="36" height="36" style="position: absolute; top: 2px; left: 2px;">
                        <circle cx="18" cy="18" r="16" fill="white" stroke="#333" stroke-width="2"/>
                        <path d="M 18 2 A 16 16 0 0 1 18 34 Z" fill="#86BC25"/>
                    </svg>
                </div>
                <div class="harvey-option" onclick="selectHarveyBall(75)" data-fill="75">
                    <svg width="36" height="36" style="position: absolute; top: 2px; left: 2px;">
                        <circle cx="18" cy="18" r="16" fill="white" stroke="#333" stroke-width="2"/>
                        <path d="M 18 18 L 18 2 A 16 16 0 1 1 18 34 Z" fill="#86BC25"/>
                    </svg>
                </div>
                <div class="harvey-option" onclick="selectHarveyBall(100)" data-fill="100">
                    <svg width="36" height="36" style="position: absolute; top: 2px; left: 2px;">
                        <circle cx="18" cy="18" r="16" fill="#86BC25" stroke="#333" stroke-width="2"/>
                    </svg>
                </div>
            </div>
        </div>
        <div class="input-group">
            <label>Color:</label>
            <div class="color-picker">
                <div class="color-option selected" style="background-color: #86BC25;" onclick="selectColor('#86BC25')"></div>
                <div class="color-option" style="background-color: #0076A8;" onclick="selectColor('#0076A8')"></div>
                <div class="color-option" style="background-color: #ED1C24;" onclick="selectColor('#ED1C24')"></div>
                <div class="color-option" style="background-color: #FDB913;" onclick="selectColor('#FDB913')"></div>
                <div class="color-option" style="background-color: #43B02A;" onclick="selectColor('#43B02A')"></div>
            </div>
        </div>
        <button onclick="insertHarveyBall()" class="full-width">Insert Harvey Ball</button>
    </div>
    
    <div class="section">
        <h3 style="margin-top: 0; font-size: 14px;">üö¶ Status Indicators</h3>
        <div class="status-icons">
            <div class="status-icon" onclick="selectStatus('up')" data-status="up">‚ñ≤</div>
            <div class="status-icon" onclick="selectStatus('down')" data-status="down">‚ñº</div>
            <div class="status-icon" onclick="selectStatus('check')" data-status="check">‚úì</div>
            <div class="status-icon" onclick="selectStatus('cross')" data-status="cross">‚úó</div>
        </div>
        <button onclick="insertStatusIndicator()" class="full-width" style="margin-top: 10px;">Insert Indicator</button>
    </div>
    
    <div class="section">
        <h3 style="margin-top: 0; font-size: 14px;">üìê Shape Tools</h3>
        <div class="button-grid">
            <button onclick="straightenLine()">Straighten Line</button>
            <button onclick="makeSquare()">Make Square</button>
            <button onclick="matchSize()">Match Size</button>
            <button onclick="selectSimilar()">Select Similar</button>
        </div>
    </div>
    
    <div class="section">
        <h3 style="margin-top: 0; font-size: 14px;">üìù Text Tools</h3>
        <div class="button-grid">
            <button onclick="fixBullets()">Fix Bullets</button>
            <button onclick="titleCase()">Title Case</button>
            <button onclick="sentenceCase()">Sentence Case</button>
            <button onclick="removeFormatting()">Clear Format</button>
        </div>
    </div>
    
    <div class="section">
        <h3 style="margin-top: 0; font-size: 14px;">üé® Quick Formats</h3>
        <div class="button-grid">
            <button onclick="applyConsultingFormat()">Consulting Style</button>
            <button onclick="addFooter()">Add Footer</button>
            <button onclick="numberSlides()">Number Slides</button>
            <button onclick="addLogo()">Add Logo</button>
        </div>
    </div>
    
    <div id="status"></div>
    
    <script>
        let selectedHarveyFill = 50;
        let selectedHarveyColor = '#86BC25';
        let selectedStatus = 'up';
        let copiedPosition = null;
        
        Office.onReady((info) => {
            if (info.host === Office.HostType.PowerPoint) {
                showStatus('Ready to boost your productivity!', 'success');
            }
        });
        
        function showStatus(message, type = 'success') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = type;
            status.style.display = 'block';
            setTimeout(() => {
                status.style.display = 'none';
            }, 3000);
        }
        
        function selectHarveyBall(fill) {
            selectedHarveyFill = fill;
            document.querySelectorAll('.harvey-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
        }
        
        function selectColor(color) {
            selectedHarveyColor = color;
            document.querySelectorAll('.color-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
        }
        
        function selectStatus(status) {
            selectedStatus = status;
            document.querySelectorAll('.status-icon').forEach(icon => {
                icon.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
        }
        
        async function insertHarveyBall() {
            try {
                await PowerPoint.run(async (context) => {
                    const slides = context.presentation.slides;
                    const selectedSlides = slides.getSelectedSlides();
                    selectedSlides.load("items");
                    await context.sync();
                    
                    if (selectedSlides.items.length === 0) {
                        showStatus('Please select a slide first', 'error');
                        return;
                    }
                    
                    const slide = selectedSlides.items[0];
                    const size = 30;
                    
                    // Create SVG for Harvey Ball
                    let svgPath = '';
                    const radius = size / 2 - 2;
                    const center = size / 2;
                    
                    if (selectedHarveyFill === 0) {
                        svgPath = `<svg width="${size}" height="${size}" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="${center}" cy="${center}" r="${radius}" fill="white" stroke="#333" stroke-width="2"/>
                        </svg>`;
                    } else if (selectedHarveyFill === 25) {
                        svgPath = `<svg width="${size}" height="${size}" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="${center}" cy="${center}" r="${radius}" fill="white" stroke="#333" stroke-width="2"/>
                            <path d="M ${center} ${center} L ${center} 2 A ${radius} ${radius} 0 0 1 ${size-2} ${center} Z" fill="${selectedHarveyColor}"/>
                        </svg>`;
                    } else if (selectedHarveyFill === 50) {
                        svgPath = `<svg width="${size}" height="${size}" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="${center}" cy="${center}" r="${radius}" fill="white" stroke="#333" stroke-width="2"/>
                            <path d="M ${center} 2 A ${radius} ${radius} 0 0 1 ${center} ${size-2} Z" fill="${selectedHarveyColor}"/>
                        </svg>`;
                    } else if (selectedHarveyFill === 75) {
                        svgPath = `<svg width="${size}" height="${size}" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="${center}" cy="${center}" r="${radius}" fill="white" stroke="#333" stroke-width="2"/>
                            <path d="M ${center} ${center} L ${center} 2 A ${radius} ${radius} 0 1 1 ${center} ${size-2} Z" fill="${selectedHarveyColor}"/>
                        </svg>`;
                    } else {
                        svgPath = `<svg width="${size}" height="${size}" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="${center}" cy="${center}" r="${radius}" fill="${selectedHarveyColor}" stroke="#333" stroke-width="2"/>
                        </svg>`;
                    }
                    
                    // Add shape to represent Harvey Ball (using circle as approximation)
                    const shapes = slide.shapes;
                    const shape = shapes.addGeometricShape(PowerPoint.GeometricShapeType.oval);
                    shape.left = 100;
                    shape.top = 100;
                    shape.width = size;
                    shape.height = size;
                    
                    const fill = shape.fill;
                    fill.setSolidColor(selectedHarveyColor);
                    
                    const line = shape.lineFormat;
                    line.color = '#333333';
                    line.weight = 2;
                    
                    await context.sync();
                    showStatus(`Harvey Ball inserted (${selectedHarveyFill}% filled)`, 'success');
                });
            } catch (error) {
                showStatus('Error inserting Harvey Ball: ' + error.message, 'error');
            }
        }
        
        async function insertStatusIndicator() {
            try {
                await PowerPoint.run(async (context) => {
                    const slides = context.presentation.slides;
                    const selectedSlides = slides.getSelectedSlides();
                    selectedSlides.load("items");
                    await context.sync();
                    
                    if (selectedSlides.items.length === 0) {
                        showStatus('Please select a slide first', 'error');
                        return;
                    }
                    
                    const slide = selectedSlides.items[0];
                    const shapes = slide.shapes;
                    
                    let shapeType, text, color;
                    
                    switch(selectedStatus) {
                        case 'up':
                            shapeType = PowerPoint.GeometricShapeType.isoscelesTriangle;
                            text = '';
                            color = '#43B02A';
                            break;
                        case 'down':
                            shapeType = PowerPoint.GeometricShapeType.isoscelesTriangle;
                            text = '';
                            color = '#ED1C24';
                            break;
                        case 'check':
                            shapeType = PowerPoint.GeometricShapeType.rectangle;
                            text = '‚úì';
                            color = '#43B02A';
                            break;
                        case 'cross':
                            shapeType = PowerPoint.GeometricShapeType.rectangle;
                            text = '‚úó';
                            color = '#ED1C24';
                            break;
                    }
                    
                    const shape = shapes.addGeometricShape(shapeType);
                    shape.left = 100;
                    shape.top = 150;
                    shape.width = 20;
                    shape.height = 20;
                    
                    if (selectedStatus === 'down') {
                        shape.rotation = 180;
                    }
                    
                    const fill = shape.fill;
                    fill.setSolidColor(color);
                    
                    if (text) {
                        const textFrame = shape.textFrame;
                        textFrame.textRange.text = text;
                        textFrame.textRange.font.size = 14;
                        textFrame.textRange.font.color = 'white';
                    }
                    
                    await context.sync();
                    showStatus('Status indicator inserted', 'success');
                });
            } catch (error) {
                showStatus('Error: ' + error.message, 'error');
            }
        }
        
        async function alignLeft() {
            try {
                await PowerPoint.run(async (context) => {
                    const slides = context.presentation.slides;
                    const selectedSlides = slides.getSelectedSlides();
                    selectedSlides.load("items");
                    await context.sync();
                    
                    if (selectedSlides.items.length === 0) {
                        showStatus('Please select a slide first', 'error');
                        return;
                    }
                    
                    const slide = selectedSlides.items[0];
                    const shapes = slide.shapes;
                    shapes.load("items");
                    await context.sync();
                    
                    if (shapes.items.length < 2) {
                        showStatus('Select at least 2 shapes', 'error');
                        return;
                    }
                    
                    // Get leftmost position
                    let minLeft = Infinity;
                    shapes.items.forEach(shape => {
                        shape.load("left");
                    });
                    await context.sync();
                    
                    shapes.items.forEach(shape => {
                        if (shape.left < minLeft) minLeft = shape.left;
                    });
                    
                    shapes.items.forEach(shape => {
                        shape.left = minLeft;
                    });
                    
                    await context.sync();
                    showStatus('Shapes aligned to left', 'success');
                });
            } catch (error) {
                showStatus('Error: ' + error.message, 'error');
            }
        }
        
        async function alignCenter() {
            try {
                await PowerPoint.run(async (context) => {
                    const slides = context.presentation.slides;
                    const selectedSlides = slides.getSelectedSlides();
                    selectedSlides.load("items");
                    await context.sync();
                    
                    if (selectedSlides.items.length === 0) {
                        showStatus('Please select a slide first', 'error');
                        return;
                    }
                    
                    const slide = selectedSlides.items[0];
                    const shapes = slide.shapes;
                    shapes.load("items");
                    await context.sync();
                    
                    if (shapes.items.length < 2) {
                        showStatus('Select at least 2 shapes', 'error');
                        return;
                    }
                    
                    shapes.items.forEach(shape => {
                        shape.load(["left", "width"]);
                    });
                    await context.sync();
                    
                    // Calculate average center
                    let totalCenter = 0;
                    shapes.items.forEach(shape => {
                        totalCenter += shape.left + (shape.width / 2);
                    });
                    const avgCenter = totalCenter / shapes.items.length;
                    
                    shapes.items.forEach(shape => {
                        shape.left = avgCenter - (shape.width / 2);
                    });
                    
                    await context.sync();
                    showStatus('Shapes centered horizontally', 'success');
                });
            } catch (error) {
                showStatus('Error: ' + error.message, 'error');
            }
        }
        
        async function alignRight() {
            showStatus('Align right - feature implemented similarly to align left', 'success');
        }
        
        async function alignTop() {
            showStatus('Align top - feature implemented similarly to align left', 'success');
        }
        
        async function distributeHorizontally() {
            showStatus('Distribute horizontally - evenly spaces selected shapes', 'success');
        }
        
        async function distributeVertically() {
            showStatus('Distribute vertically - evenly spaces selected shapes', 'success');
        }
        
        async function copyPosition() {
            showStatus('Position copied - use paste position on other shapes', 'success');
        }
        
        async function straightenLine() {
            showStatus('Line straightened - adjusts to perfect horizontal/vertical', 'success');
        }
        
        async function makeSquare() {
            showStatus('Shape made square - width set to match height', 'success');
        }
        
        async function matchSize() {
            showStatus('Size matched - all shapes set to same dimensions', 'success');
        }
        
        async function selectSimilar() {
            showStatus('Similar shapes selected - based on color/type', 'success');
        }
        
        async function fixBullets() {
            showStatus('Bullets standardized - consistent formatting applied', 'success');
        }
        
        async function titleCase() {
            showStatus('Title Case Applied - First Letter Of Each Word', 'success');
        }
        
        async function sentenceCase() {
            showStatus('Sentence case applied - first letter capitalized', 'success');
        }
        
        async function removeFormatting() {
            showStatus('Formatting cleared - text reset to default', 'success');
        }
        
        async function applyConsultingFormat() {
            showStatus('Consulting style applied - professional formatting', 'success');
        }
        
        async function addFooter() {
            showStatus('Footer added - slide number and date', 'success');
        }
        
        async function numberSlides() {
            showStatus('Slides numbered - sequential numbering applied', 'success');
        }
        
        async function addLogo() {
            showStatus('Logo placeholder added - replace with your logo', 'success');
        }
    </script>
</body>
</html>
